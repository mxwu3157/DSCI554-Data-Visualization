<!DOCTYPE html>
<html>

<head>
  <title>DSCI 554 Lab 1 ex1</title>
  <link href="./node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="./style.css">

  <link rel="stylesheet" href="./github-dark-dimmed.min.css">
  <script src="./highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</head>

<body>
  <h1>Demo: Google sheets multi-line chart</h1>

  <div>To download the daily <a target="_blank"
      href="https://github.com/CSSEGISandData/COVID-19/blob/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv">confirmed
      daily covid19 cases</a> from the <a target="_blank" href="https://github.com/CSSEGISandData/COVID-19">CCSE
      dataset</a> there are a few altenatives:
      <ul>
        <li>With wget or curl
          <pre><code class="sh">wget https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv</code></pre>
        </li>
        <li>With the browser go to <a target="_blank"
          href="https://github.com/CSSEGISandData/COVID-19/blob/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv">confirmed
          daily covid19 cases</a> Github file or with the GitHub VS Code interface (from the GitHub interface click <kbd>.</kbd> then <kbd>EXPLORER &gt; Right click &gt; Download</kbd></li>
      </ul>
  I then import the csv file in Google Sheet with <kbd>File &gt; Import</kbd> (leaving `Convert text and numbers, dates, and formulas` checked). I then filter the <a
    target="_blank" 
    href="https://docs.google.com/spreadsheets/d/11ibE0McOyOH9o7HP-7o_21IEfFjuRqpLK6Q0rAtIIX8/edit?usp=sharing">Google
    sheet</a> to include the countries and fields I am interested:
    <ol>
      <li>Afghanistan</li>
      <li>Albania</li>
      <li>Algeria</li>
    </ol>
  </div>

  <div>I can create a multi-line chart by selecting the data and clicking on Explore in the status bar.</div>

  <div>Alternatively we can unpivot the data then create the plot:
    <ul>
      <li>Select all the dates and <kbd>Format &gt; Number &gt; Plain text</kbd></li>
      <li>Add rows to the sheet to fit the long format we need</li>
      <li>Apply the formula to an empty cell in the first column:
        <pre><code class="xls">=ARRAYFORMULA(
        split(
            flatten(
              A2:A4&"|"&B1:AIX1&"|"&B2:AIX4
            ),"|"
        )
    )</code></pre></li>
    </ul>
  </div>

  <div class="mb-10">I export the chart and embed it as an <code>iframe</code> from the <kbd>&vellip;</kbd> chart menu:</div>
  <kbd>&vellip; menu &rightarrow; Publish chart &rightarrow; Embed</kbd>

  <div class="mt-10">Similarly I can export a scalable vector graphics (SVG) image:</div>
  <kbd>&vellip; menu &rightarrow; Download &rightarrow; Scalable Vector Graphics (.svg)</kbd>

  <div class="mt-10">This is a <a
      target="_blank" href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQAoOZQM3gJ5_o9ZhHu9cxaPkj45OqO5kOxS9beRF6GHZKgTj3jzCtD3FRBjoElHk2EvQrDYObXjpLu/pubchart?oid=451767540&format=interactive">link</a>
    to the multi-line chart I created, and this is the chart embedded using an iframe:</div>

  <iframe width="600" height="371" seamless frameborder="0" scrolling="no"
    src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQAoOZQM3gJ5_o9ZhHu9cxaPkj45OqO5kOxS9beRF6GHZKgTj3jzCtD3FRBjoElHk2EvQrDYObXjpLu/pubchart?oid=451767540&amp;format=interactive"></iframe>

  <h1>üèãüèΩ‚Äç‚ôÇÔ∏è ex1.1: Google Sheets line chart</h1>

  <p>Download raw daily <a target="_blank"
      href="https://github.com/CSSEGISandData/COVID-19/blob/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv">confirmed
      daily covid19 cases</a> from the <a target="_blank" href="https://github.com/CSSEGISandData/COVID-19">CCSE
      dataset</a>
    and create a multi-line chart in Google Sheets for 10 countries of your choice. Make sure to share the Google Sheet
    with everyone at USC!</p>

  <div class="answer">
    <cap>Answer</cap>

    <p>
      <a target="_blank" href="https://docs.google.com/spreadsheets/d/1NWCpzlaK5Zgglzc4P5oBhUFmkmE6xiM3dTGAFd5TAGA/edit?usp=sharing">Link</a> to google sheet.
    </p>

    <p>
      These are the 10 countries I have picked:
    <ol>
      <li>Australia</li>
      <li>Canada</li>
      <li>China</li>
      <li>Germany</li>
      <li>Korea, South</li>
      <li>Malaysia</li>
      <li>Russia</li>
      <li>Singapore</li>
      <li>United Kingdom</li>
      <li>US</li>
    </ol>
    </p>

    <p>Line chart as iframe:</p>
    <!-- insert iframe with chart here -->
    <iframe width="664" height="541" seamless frameborder="0" scrolling="no" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQzb2MHQmk21j-ARBZldsRzN6QoZSD1FE-dD5ycv_afONiFqCE384FB3kDYuNBs8L97PjLshPWKce1e/pubchart?oid=1236500036&amp;format=interactive"></iframe>    

    <p>Line chart as svg image:</p>
    <!-- save your chart as chart.svg in the same folder as
            this file, verify it is visible in the page and
            remember to it to the repository! -->
    <img src="charts/chart.svg" />
  </div>

  <h1>üèãüèΩ‚Äç‚ôÇÔ∏è ex1.2: data wrangling</h1>

  Use pandas.melt in a Jupyter notebook to filter and unpivot the data (i.e., put the data in long format) and export in csv.

  <div class="answer">
    <cap>Answer</cap>

    <p>
      Jupyter notebook code:
      <pre><code class="python">
        import pandas as pd
        df = pd.read_csv('time_series_covid19_confirmed_global.csv')
        
        country = ['Australia', 'Canada', 'China', 'Germany', 'Korea, South', 'Malaysia', 'Russia',
        'Singapore','United Kingdom', 'US']
        
        df_filter = df.loc[df['Country/Region'].isin(country)] 
        df_filter.drop(columns=['Lat','Long','Province/State'], inplace=True)
        df_group = df_filter.groupby(['Country/Region']).sum()
        df_group['Country/Region'] = df_group.index
        
        df_melt = pd.melt(df_group, id_vars=['Country/Region'], value_vars=df_group.columns[:-1])
        df_melt.to_csv('unpivot_covid_10c.csv')</code></pre>
    </p>
  </div>

  <a target="_blank" href="./index.html">‚¨ÖÔ∏è Back</a>
</body>

</html>